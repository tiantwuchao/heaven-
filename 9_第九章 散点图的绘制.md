### 散点图的绘制



**散点图（scatter diagram）又称为散点分布图，是以一个特征为横坐标，另一个特征**
**为纵坐标，利用坐标点（散点）的分布形态反映特征间的统计关系的一种图形。**



**散点图有什么用处？**

1、数据用图表来展示，显然比较直观，在工作汇报等场合能起到事半功倍的效果，让听者更容易接受，理解你所处理的数据。

2、散点图更偏向于研究型图表，能让我们发现变量之间隐藏的关系为我们决策作出重要的引导作用。

3、散点图核心的价值在于发现变量之间的关系，千万不要简单地将这个关系理解为线性回归关系。变量间的关系有很多，如线性关系、指数关系、对数关系等等，当然，没有关系也是一种重要的关系。

4、散点图经过回归分析之后，可以对相关对象进行预测分析，进而做出科学的决策，而不是模棱两可。比如说：医学里的白细胞散点图可以在医学检测方面为我们健康提供精确的分析，为医生后续的判断做出重要的技术支持。

经常用来显示分布或者比较几个变量的相关性或者分组。值是由点在图表中的位置表示，类别是由图表中的不同标记表示，通常用于比较跨类别的数据。另外，如果可以使用曲线拟合的散点，也可以用来反映数据的变化趋势。



#### 简单的示例

```python
import random
import matplotlib.pyplot as plt

#matplotlib画图中中文显示会有问题，需要这两行设置默认字体
plt.rcParams['font.sans-serif']=['SimHei']
plt.rcParams['axes.unicode_minus'] = False


x1 = [random.randint(1,1000) for i in  range(100)]
y1 = [random.randint(1,1000) for i in  range(100)]
x2 = [random.randint(1,1000) for i in  range(100)]
y2 = [random.randint(1,1000) for i in  range(100)]


colors1 = '#00CED1' #点的颜色 RGB颜色表
colors2 = '#DC143C'
area = 3.14 * 4**2  # 点面积 
# 画散点图
 
plt.xlabel('X')
plt.ylabel('Y')
plt.scatter(x1, y1, s=area, c=colors1, alpha=0.4, label='类别A')
plt.scatter(x2, y2, s=area, c=colors2, alpha=0.4, label='类别B')

plt.legend()

plt.show()

```

![image-20210517154450938](散点图的绘制/image-20210517154450938.png)



```python
import numpy as np
import matplotlib.pyplot as plt

plt.rcParams['font.sans-serif']=['simhei']  #标题字体
plt.title('scatter测试图')     #图片标题
np.random.seed(1)   #使用每次生成的随即数都相同

x = np.random.rand(5)
y = np.random.rand(5)


area = 20*10

plt.scatter(x, y, s=area,c='b',marker='o')
plt.show()
```

![image-20210517154519851](散点图的绘制/image-20210517154519851.png)





```python
%matplotlib inline
import pandas as pd
import matplotlib.pyplot as plt

plt.rcParams['font.sans-serif'] = 'SimHei'
plt.rcParams['axes.unicode_minus'] = False

data = pd.read_csv(r'./housing.csv')

fig,ax = plt.subplots(figsize=(9,6)) #  创建画布和画图区域
ax.scatter(x='longitude',y='latitude',data=data)  # x是经度 , y 是维度  data表示依据哪个数据集 

data.head()
```

![image-20210517154753980](散点图的绘制/image-20210517154753980.png)



![image-20210517154911246](散点图的绘制/image-20210517154911246.png)







散点图大致的勾勒出了加州的地理轮廓，一个点代表了一个街区。但这张图反映不出**街区之间的密集程度**，原因在于，一个街区的面积相对于一个州的面积而言几乎可以忽略不计，所以很多时候两个街区在经纬度上相差不大，在图上的表现就是重叠成一个点。

针对这个问题，可以设置`alpha`参数，**控制散点的透明度**，设置了透明度之后，颜色越深的部分就代表了越多的散点在这里重叠，即该区域的街区密集程度更大，如下

```python
fig,ax = plt.subplots(figsize=(9,6))

# alpha取值在0-1之间，具体取何值取决于对密集程度的定义，这里取0.3
ax.scatter(x='longitude',y='latitude',data=data,alpha=0.3)

```

![image-20210514154030467](散点图的绘制/image-20210514154030467.png)

**所以通过`alpha`（透明度）的设置，在散点图上非常直观地展示了街区密集程度这一信息。**



接着，我们可以看看各个街区的人口分布情况，如何做呢？

图中一个点代表了一个街区，所以需要对散点的样式进行设置，散点的可以设置的属性有颜色，大小，形状等。

实际选择哪种视实际情况（效果，研究目的）而定，这里选用大小来反映街区的人口数量，即设置参数`s`，将**散点的大小和人口多少挂钩**。为了便于对比，将设置前后的图放到了一起。



```python
fig,ax = plt.subplots(1,2,figsize=(20,6))

ax[0].scatter(x='longitude',y='latitude',data=data,alpha=0.3)
ax[0].set_title('设置前',size=16)
ax[1].scatter(x='longitude',y='latitude',data=data,alpha=0.3,s=data['population']/100,label='population')
# s表示的是size ,就是大小的意思 但只能写  s
ax[1].set_title('设置后',size=16)
```



![image-20210514155326697](散点图的绘制/image-20210514155326697.png)



可以看到，对于加州北部(红色框内)而言，不仅街区密度小(浅色比较多)，而且街区内的人也较少（散点面积较小）。同时，对于黄色区域内,**虽然街区密度较大，但人口密度明显稀疏很大**

最后，结合街区密集度和人口密集度，再看看各个街区的价格分布，这里将颜色和房价高低挂钩，通过**颜色的渐变**来展现房价高低，颜色由蓝到红代表了价格由低到高，具体用到的参数为`c`。

```python
fig,ax = plt.subplots(figsize=(9,6))
ax_plot = ax.scatter(x='longitude',y='latitude',alpha=0.4,s=data['population']/100,
                     c='median_house_value',cmap=plt.get_cmap('jet'),data=data)
# median_house_value 表示data数据中的房价 


# 加上颜色棒
# 参数mappable理解起来就是我们需要提供一个可以映射颜色的对象ax_plot，这个对象就是我们作的图
# 参数ax用来指示colorbar()获取到的渐变色条在哪里显示，如果我们设置ax=ax[0]那它就在ax[0]的区域显示，这里就是 ax 所以 ax = ax
fig.colorbar(ax_plot,ax=ax)
```

![image-20210514160731257](散点图的绘制/image-20210514160731257.png)

注意 :

`cmap=plt.get_cmap('jet')`逐渐改变亮度和颜色渐渐增加。应该用于表示**有顺序的信息**。

可以把`'jet'`换成其他试试看 ,特别注意   **如果`jet_r`表示颜色倒叙**



![image-20210514161200728](散点图的绘制/image-20210514161200728.png)

![image-20210514161215984](散点图的绘制/image-20210514161215984.png)







通过对颜色的设定，整个图看上去颜值高了很多，同时，也可以得到一些结论：

- 房价比较高的区域集中于两个中心，且都靠近海湾
- 房价高的地方对应的人口密集度也较高

虽然这两个数据分析的结论比较显而易见，但这里主要想说的是，用散点图也能够展现出丰富的信息，在这个案例中，用**`alpha`呈现了街区密集度，`s`呈现了人口密集度，`c`反映房价高低，再加上横纵坐标的经纬度，一共反映了5个维度的信息。**



##### 案例

```python
# 导入模块
import pandas as pd
import matplotlib.pyplot as plt

# 设置绘图风格
plt.style.use('seaborn')
# 设置中文编码和负号的正常显示
plt.rcParams['font.sans-serif'] = 'Microsoft YaHei'
plt.rcParams['axes.unicode_minus'] = False

cars = pd.read_csv('./data_former/cars.csv')  # 查看一下cars
# 绘图
plt.scatter(cars.speed, # x轴数据为汽车速度
            cars.dist, # y轴数据为汽车的刹车距离
            s = 30, # 设置点的大小 
            c = 'blue', # 设置点的颜色
            marker = 's', # 设置点的形状
            alpha = 0.9, # 设置点的透明度
            linewidths = 0.3, # 设置散点边界的粗细
            edgecolors = 'red' # 设置散点边界的颜色
            )

plt.title('汽车速度与刹车距离的关系')
plt.xlabel('汽车速度')
plt.ylabel('刹车距离')


# 显示图形plt.show()
plt.show()
```

![image-20210514163235088](散点图的绘制/image-20210514163235088.png)



这样一张简单的散点图就呈现出来了，很明显的发现，**汽车的刹车速度与刹车距离存在正相关关系**，即随着速度的增加，刹车距离也在增加。其实这个常识不用绘图都能够发现，关键是通过这个简单的案例，让大家学会如何通过python绘制一个散点图。



##### 案例三(分组绘制)



```python
# 读取数据
iris = pd.read_csv('./iris.csv')

# 自定义颜色
colors = ['steelblue', '#9999ff', '#ff9999']

# 三种不同的花品种S
species = iris['species'].unique()
print(species)
# 通过循环的方式，完成分组散点图的绘制
for i in range(len(species)):
    plt.scatter(
                iris[iris['species'] ==species[i]]['petal_length'],  # 花瓣长度
                iris[iris['species'] ==species[i]]['petal_width'], # 花瓣宽度 
                
                s = 35, c = colors[i], label = species[i])

# 添加轴标签和标题
plt.title('花瓣长度与宽度的关系')
plt.xlabel('花瓣长度')
plt.ylabel('花瓣宽度')

# 添加图例
plt.legend()
# 显示图形
plt.show()

```

从图中可以发现，三种花的花瓣长度与宽度之间都存在正向的关系，只不过品种setasa的体型比较小，数据点比较聚集。

![image-20210517101636270](散点图的绘制/image-20210517101636270.png)



